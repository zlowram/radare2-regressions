NAME=f?flag
FILE=-
EXPECT64=aGVsbG8KCg==
CMDS64=ZiBmb289MTIzCmY/Zm9vOz8/ID9lIGhlbGxvCmY/YmFyOz8/ID9lIHdvcmxkCgo=
RUN
NAME=fs-fd-flags-visibility
FILE=-
EXPECT64=dmlzaWJsZQoweDAwMDAwMDAwIDEgdmlzaWJsZQoK
CMDS64=ZnMgamVqZQpmIGhpZGRlbgpmcyBqb2pvCmYgdmlzaWJsZQpmZApmCgo=
RUN
NAME=f command with space
FILE=-
EXPECT64=MHgwMDAwMTAwMCAxIGZvb2JhcgoK
CMDS64=ZiAgZm9vYmFyPTB4MTAwMApmCgo=
RUN
NAME=no flags
FILE=-
EXPECT64=Cg==
CMDS64=ZgoK
RUN
NAME=no flags*
FILE=-
EXPECT64=Cg==
CMDS64=ZioKCg==
RUN
NAME=fs *
FILE=../bins/elf/analysis/main
EXPECT64=MAoK
CMDS64=ZnMgKgpmc34/XioKCg==
RUN
NAME=fs *
FILE=../bins/elf/analysis/main
EXPECT64=NQoK
CMDS64=ZnMgKgpmc34/KgoK
RUN
NAME=fs *
FILE=malloc://1024
EXPECT64=MHgwMDAwMDAwMCAxIGZsYWdfaW5fZnMxCjB4MDAwMDAwMDAgMSBmbGFnX2luX2ZzMgoK
CMDS64=ZnMtKgpmcyBmbGFnc3BhY2VfMQpmIGZsYWdfaW5fZnMxCmZzIGZsYWdzcGFjZV8yCmYgZmxhZ19pbl9mczIKZnMgKgpmCgo=
RUN
NAME=fs test_flagspace
FILE=../bins/elf/analysis/main
EXPECT64=MQoK
CMDS64=ZnMgdGVzdF9mbGFnc3BhY2UKZnN+P3Rlc3RfZmxhZ3NwYWNlCgo=
RUN
NAME=fs-test_flagspace
FILE=../bins/elf/analysis/main
EXPECT64=MAoK
CMDS64=ZnMgdGVzdF9mbGFnc3BhY2UKZnMtdGVzdF9mbGFnc3BhY2UKZnN+P3Rlc3RfZmxhZ3NwYWNlCgo=
RUN
NAME=fs-test_flagspace
FILE=../bins/elf/analysis/main
EXPECT64=MAoK
CMDS64=ZnMtKgpmc34/MAoK
RUN
NAME=fs-.
FILE=malloc://1024
EXPECT64=MAoK
CMDS64=ZnMgdGVzdF9mbGFnc3BhY2UKZnMgdGVzdF9ibG9oCmZzIHRlc3RfYmxhaApmcy0uCmZzfj90ZXN0X2JsYWgKCg==
RUN
NAME=fsm
FILE=../bins/elf/analysis/main
EXPECT64=MCAgICAxICogdGVzdAoK
CMDS64=ZnMtKgpmcyB0ZXN0CmZzbSBzdHIuSGVsbG9fV29ybGQgdGVzdApmcwoK
RUN
NAME=fsr
FILE=../bins/elf/analysis/main
EXPECT64=MCAgICAwICogdGVzdDIKCg==
CMDS64=ZnMtKgpmcyB0ZXN0CmZzIHRlc3QKZnNyIHRlc3QyCmZzCgo=
RUN
NAME=fSn
FILE=malloc://1024
EXPECT64=MHgwMDAwMDAwMCAxIGEKMHgwMDAwMDAwMCAxIGIKMHgwMDAwMDAwMCAxIGMKCg==
CMDS64=ZiBjIEAgMHgwMDAwMDAwMApmIGIgQCAweDAwMDAwMDAwCmYgYSBAIDB4MDAwMDAwMDAKZlNuCmYKCg==
RUN
NAME=fSo
FILE=malloc://1024
EXPECT64=MHgwMDAwMDAwMCAxIGMKMHgwMDAwMDAwMSAxIGIKMHgwMDAwMDAwMiAxIGEKCg==
CMDS64=ZiBhIEAgMHgwMDAwMDAwMgpmIGIgQCAweDAwMDAwMDAxCmYgYyBAIDB4MDAwMDAwMDAKZlNvCmYKCg==
RUN
NAME=fr
FILE=malloc://1024
EXPECT64=MHgwMDAwMDAwMCAxIGJsb2gKCg==
CMDS64=ZiBibGFoCmZyIGJsYWggYmxvaApmCgo=
RUN
NAME=fm
FILE=malloc://1024
EXPECT64=MHgwMDAwMDAxMCAxIGJsYWgKCg==
CMDS64=ZiBibGFoCmZtIDB4MTAKZgoK
RUN
NAME=fl
FILE=malloc://1024
EXPECT64=MHgwMDAwMDAwMwoweDAwMDAwMDIxIDEyIHRlc3QKMHgwMDAwMDAyMSAzMzMgdGVzdAoK
CMDS64=ZiBibGFoIDB4MDAwMDAwMGEKZmwgYmxhaCAweDAwMDAwMDAzCmZsCmYtYmxhaApmIHRlc3QgMTIgQCAzMwpmCmZsIHRlc3QgMzMzCmYKCg==
RUN
NAME=fj
FILE=malloc://1024
EXPECT64=W3sibmFtZSI6ImJsYWgiLCJzaXplIjoxMCwib2Zmc2V0IjoxMX0seyJuYW1lIjoiYmxvaCIsInNpemUiOjMsIm9mZnNldCI6Mn1dCgo=
CMDS64=ZiBibGFoIDB4MDAwMDAwMGEgQCAweDAwMDAwMDBiCmYgYmxvaCAweDAwMDAwMDAzIEAgMHgwMDAwMDAwMgpmagoK
RUN
NAME=fe
FILE=malloc://1024
EXPECT64=MHgwMDAwMDAwMCAxIGEuMAoweDAwMDAwMDAwIDEgYS4xCjB4MDAwMDAwMDAgMSBhLjIKMHgwMDAwMDAwMCAxIGIuMAoweDAwMDAwMDAwIDEgYi4xCjB4MDAwMDAwMDAgMSBiLjIKCg==
CMDS64=ZmUgYQpmZSBhCmZlIGEKZmUtCmZlIGIKZmUgYgpmZSBiCmYKCg==
RUN
NAME=fd
FILE=malloc://1024
EXPECT64=YS4wICsgMjU2Cgo=
CMDS64=ZmUgYQpmZCAweDEwMAoK
RUN
NAME=fC
FILE=malloc://1024
EXPECT64=MQoK
CMDS64=ZiBhCmZDIGEgYmxhYmxhCnBkfj9ibGFibGEKCg==
RUN
NAME=fb
FILE=malloc://1024
EXPECT64=MHgwMDAwMDEwMCAxIGEKCg==
CMDS64=ZmIgMHgxMDAKZiBhCmYKCg==
RUN
NAME=fb2
FILE=malloc://1024
EXPECT64=MHgwMDAwMDEwMCAxIGEuMAoweDAwMDAwMTAwIDEgYS4xCjB4MDAwMDAxMDAgMSBhLjIKCg==
CMDS64=ZmUgYQpmZSBhCmZlIGEKZmIgMHgxMDAgYS4qCmYKCg==
RUN
NAME=f--
FILE=malloc://1024
EXPECT64=Cg==
CMDS64=ZiBhCmYtLQpmCgo=
RUN
NAME=f.
FILE=../bins/elf/analysis/main
EXPECT64=MHgwMDQwMDQxMCBibGFoICAgW2VudHJ5MCArIDBdCgo=
CMDS64=YWFhCmYuYmxhaApmLgpmLi1ibGFoQGVudHJ5MApmLgoK
RUN
NAME=f. display
FILE=../bins/elf/analysis/main
EXPECT64=ICAgICAgICAgICAuYmxhaDoKICAgICAgICAgICAgICAgMzFlZCAgICAgICAgICAgeG9yIGVicCwgZWJwCgo=
CMDS64=YWFhCmUgYXNtLmFyY2g9eDg2CmUgYXNtLmJpdHM9MzIKcyBlbnRyeTAKZSBhc20ucmVmbGluZXM9ZmFsc2UKZSBhc20ub2Zmc2V0PWZhbHNlCmUgYXNtLmZ1bmN0aW9ucz1mYWxzZQplIGFzbS5jb21tZW50cz1mYWxzZQpmLS0KZi5ibGFoCnBkIDEKCg==
RUN
NAME=Set/get
FILE=-
EXPECT64=MHgwMDAwMDAwMCAxIGNhdAoweDAwMDAwMDAwIDEyIHJpbW1lcgoweDAwMDAwMjlhIDMyIGxpc3RlcgoweDAwMDAwMjlhIDMyIGtyeXRlbgoweDAwMDAwMDBjIDEgc2t1dHRlcgoK
CMDS64=CmYgY2F0CmYgcmltbWVyIDEyCmYgbGlzdGVyIDMyQDY2NgpmIGtyeXRlbiAzMiA2NjYKZitza3V0dGVyIDEgQCAxMgpmCgo=
RUN
NAME=flags (JSON)
FILE=-
EXPECT64=W3sibmFtZSI6ImNhdCIsInNpemUiOjEsIm9mZnNldCI6MH0seyJuYW1lIjoicmltbWVyIiwic2l6ZSI6MTIsIm9mZnNldCI6MH0seyJuYW1lIjoibGlzdGVyIiwic2l6ZSI6MzIsIm9mZnNldCI6NjY2fSx7Im5hbWUiOiJrcnl0ZW4iLCJzaXplIjozMiwib2Zmc2V0Ijo2NjZ9LHsibmFtZSI6InNrdXR0ZXIiLCJzaXplIjoxLCJvZmZzZXQiOjEyfV0K
CMDS64=CiMgQWRkIGZsYWdzLgpmIGNhdApmIHJpbW1lciAxMgpmIGxpc3RlciAzMkA2NjYKZiBrcnl0ZW4gMzIgNjY2CmYrc2t1dHRlciAxIEAgMTIKZmoKCg==
RUN
NAME=flag alias
FILE=-
EXPECT64=MHg2Cgo=
CMDS64=CmZhIGZvbz1iYXIrMwpmIGJhcj0zCj92IGZvbwoK
RUN
NAME=flag alias 2
FILE=-
EXPECT64=MHg2Cgo=
CMDS64=CmZhIGZvbyBiYXIrMwpmIGJhcj0zCj92IGZvbwoK
RUN
NAME=flag alias infinite check
FILE=-
EXPECT64=MHgzCgo=
CMDS64=CmZhIGZvbz1mb28rMwo/diBmb28KCg==
RUN
NAME=flag prefix dump
FILE=-
EXPECT64=MTAxCjEwMgoK
CMDS64=CmYgamlqaT0xCmYgam9qbz0yCmYgYmFzZT0xMDAKLmYqYmFzZQo/dmkgamlqaQo/dmkgam9qbwoK
RUN
NAME=rename flags from bin
FILE=../bins/elf/analysis/main
EXPECT64=MHgwMDQwMDUyMCAxMzcgc3ltLl9fbGliY19jc3VfaW5pdAoweDAwNDAwNTIwIDEzNyBuZXduYW1lCgo=
CMDS64=Zn5zeW0uX19saWJjX2NzdV9pbml0CmZyIHN5bS5fX2xpYmNfY3N1X2luaXQgbmV3bmFtZQpmfnN5bS5fX2xpYmNfY3N1X2luaXQKZn5uZXduYW1lCgo=
RUN
NAME=f+
FILE=-
EXPECT64=MgoK
CMDS64=Zitmb289MTAKZitiYXI9MjAKZitjb3c9MTAKZitsb3c9MjAKZn4/Cgo=
RUN
NAME=dup flags with filter
FILE=../bins/elf/ifunc_rel64
EXPECT64=MHgwMDQ5YWQ0MCAxNjggb2JqLl9JT19oZWxwZXJfanVtcHMKMHgwMDQ5YjY4MCAxNjggb2JqLl9JT19oZWxwZXJfanVtcHNfMQoK
CMDS64=Zn5vYmouX0lPX2hlbHBlcl9qdW1wcwoK
RUN
NAME=flag renaming and reusing the old name for something new
FILE=malloc://1024
EXPECT64=MHgwMDAwMDEwMCAwIGJsb2gKMHgwMDAwMDIwMCAwIGJsYWgKCg==
CMDS64=ZiBibGFoID0gMHgxMDAKZnIgYmxhaCBibG9oCmYgYmxhaCA9IDB4MjAwCmYKCg==
RUN
